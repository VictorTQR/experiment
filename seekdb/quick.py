import pyseekdb
import os
import uuid
from dotenv import load_dotenv

load_dotenv()

SEEKDB_HOST = os.getenv("SEEKDB_HOST")
SEEKDB_PORT = int(os.getenv("SEEKDB_PORT"))
SEEKDB_USER = os.getenv("SEEKDB_USER")
SEEKDB_PASSWORD = os.getenv("SEEKDB_PASSWORD")
SEEKDB_DATABASE = os.getenv("SEEKDB_DATABASE")

admin = pyseekdb.AdminClient(
    host=SEEKDB_HOST,
    port=SEEKDB_PORT,
    user=SEEKDB_USER,
    password=SEEKDB_PASSWORD,
)
databases = admin.list_databases()
print(databases)

client = pyseekdb.Client(
    host=SEEKDB_HOST,
    port=SEEKDB_PORT,
    user=SEEKDB_USER,
    password=SEEKDB_PASSWORD,
    database=SEEKDB_DATABASE,
)
collection = client.get_collection("test_retrieve")
print(collection)


datas = {
    "notes": [{"序号": 1,"正文": "藏在川南的千年烟火！泸州乐道古镇承包所有惬意✨ 📍地址：泸州市纳溪区・乐道古镇 被低估的川南古镇天花板！没有过度商业化，满是老泸州的烟火气～ 青石板路蜿蜒，吊脚楼依河而建，潺潺溪流穿镇而过，随便一站都是复古大片！ 🏯必逛亮点： ▫️古盐道遗址：触摸川盐入黔的千年历史印记 ▫️吊脚楼群：木质结构超有年代感，拍照巨出片 ▫️乐道溪：夏日踩水、冬日观雾，四季皆有韵味 ▫️非遗手工作坊：体验油纸伞制作、竹编技艺 🍜必吃美食： ✅乐道古镇：浑浆豆花、红糖糍粑、麻辣凉糕、腊肉豌豆糯米饭 ✅周边特色：纳溪泡糖、护国陈醋鸡、白节酸菜鱼、天仙硐烤兔 ✅小食饮品：手工麦芽糖、桂花米酒、油纸伞主题文创雪糕 ✨游玩 Tips： ▫️泸州城区出发自驾 1h 可达，公共交通可乘公交至纳溪区再转乘乡村客运 ▫️建议下午前往，逛完古镇看夕阳映在溪面上超美 ▫️周边可串联天仙硐景区一起游玩，适合一日游 / 半日游 #泸州旅游 #乐道古镇 #川南古镇 #小众旅行地 #周末去哪儿 #非遗体验","评论": ["这个古镇也太安逸了吧！看起来就很治愈～","上周才去了，人超级少，拍照不用抢机位！","浑浆豆花好吃吗？求推荐具体店铺！","别去！就一条小破街，十分钟逛完，巨无聊！","油纸伞制作体验贵不贵呀？想带孩子去","比尧坝古镇清净多了，喜欢这种小众地方！"]},{"序号": 2,"正文": "🌿泸州避暑秘境！合江笔架山天然氧吧🌿 📍地址：泸州市合江县・笔架山景区 夏日平均气温 25℃！逃离酷暑就来这里～ 漫山遍野的绿植，空气里都是草木的清香，登顶还能俯瞰长江美景，随手拍都是森系大片！ 🚶必玩项目： ▫️徒步登山：林间步道蜿蜒曲折，沿途都是溪流瀑布 ▫️玻璃栈道：悬空观景，感受心跳加速的刺激 ▫️寺庙祈福：千年古刹法王寺，清净肃穆 ▫️森林露营：自带帐篷或租营地，夜晚看星空超浪漫 🍢必吃美食： ✅景区周边：笔架山腊肉、腊肉竹筒饭、全竹宴、法王寺烤鸡 ✅合江城区联动：合江烤鱼、豆花火锅、猪儿粑 ✅解暑饮品：手工冰粉、酸梅汤、荔枝冰饮 ✨避暑 Tips： ▫️泸州出发自驾 1.5h，景区有停车场 ▫️建议穿舒适的运动鞋，带驱蚊液、防晒用品 ▫️玻璃栈道需要单独购票，恐高者慎入 #泸州避暑 #笔架山 #天然氧吧 #森林露营 #夏日旅行","评论": ["这里也太凉快了吧！上周去重庆热惨了，想逃去这里！","步道难走吗？带老人孩子能爬不？","千万别去！门票贵，景色一般，就是个普通小山丘","法王寺烤鸡巨香！每次去都要吃两只！","露营地收费多少呀？有淋浴的地方吗？","风景超美！登顶看长江的瞬间被震撼到了！"]},{"序号": 3,"正文": "❄️川南小瑞士！泸州罗汉林初雪来袭❗️ 📍地址：泸州市叙永县分水镇・罗汉林上沅雲栖民宿 “今年泸州第一场雪在这里降落！” 海拔 1902 米的罗汉林银装素裹，云海雪景同框的梦幻场景终于被我等到啦～ 🏡民宿亮点： ▫️全景落地窗 + 地暖房：在温暖房间里躺着看飘雪太治愈 ▫️苗家酸汤火锅必吃！酸辣暖胃，搭配雪景幸福感拉满 ▫️冬日限定围炉煮茶：烤橘子🍊+ 红薯 + 非遗叙永桃片 ▫️手工体验超丰富：香篆 / 书法 / 烘焙 / 咖啡 DIY… ✨Tips： ✅自驾导航 “罗汉林” 泸州出发约 2h ✅建议住 2 天 1 夜 夜晚星空超震撼 ✅苗家酸汤锅记得提前预约 #泸州下雪 #川南雪山 #叙永旅游 #围炉煮茶 #小众旅行地","评论": ["今天下雪了吗？没有噢","请问元旦下雪吗？应该是会下的噢","这个牛吹得有点上头了！嘿嘿 运用了夸张手法","下雪路滑吧，车能开过来吗？亲 下大雪需要套链条噢","已经定了酒店，看到加我个微信吧！好滴好滴","有雾凇了吗？有的，现在去能看到～"]},{"序号": 4,"正文": "🍜泸州合江！被低估的美食之城🍜 📍地址：泸州市合江县 不止有荔枝和真龙柚！合江的美食藏都藏不住～ 从正餐到小食，每一口都是川南风味！ 🍲必吃正餐： 合江豆花、佛荫鸡汤面、猪儿粑、火烧黄鳝、笔架山腊肉、豆花火锅、合江烤鱼、全竹宴（福宝玉兰山）、荔枝宴 🏯古镇限定： 尧坝古镇：尧坝黄粑、红汤羊肉、麻辣萝卜干 福宝古镇：酸笋炒汤圆、腊味竹筒饭 🍢特色小食： 福宝酥饼、米花糖、酱油风味雪糕、合江荔枝酒、金钗石斛花茶 🍎必吃水果： 荔枝、真龙柚 ✨Tips： 各镇都有专属特色菜，建议自驾深度打卡 #这地我熟 #被低估的宝藏小城 #四川旅游 #美食小城 #泸州旅游","评论": ["合江烤鱼 YYDS！每次去都要吃两大条！","酱油风味雪糕好吃吗？听起来很奇怪","求推荐合江豆花的宝藏店铺！","全竹宴真的绝了，竹荪超鲜！","去过一次，感觉美食很一般，性价比不高","真龙柚什么时候成熟呀？想组队去摘！"]},{"序号": 5,"正文": "🏯泸州尧坝古镇！川南古民居活化石🏯 📍地址：泸州市合江县尧坝古镇 全国重点文物保护单位，非遗特色街区～ 青石板路、古民居、老茶馆，满是岁月静好的味道！ 🏃必逛亮点： 古街道、尧坝古寺、进士牌坊、非遗手工作坊 🍜必吃美食： 尧坝黄粑、红汤羊肉、麻辣萝卜干、手工苕丝糖、尧坝古镇烤肠 🌟游玩 Tips： 泸州城区出发自驾 1.5h，适合半日游，可串联合江城区一起打卡 #尧坝古镇 #泸州旅游 #川南古镇 #文物保护单位 #非遗特色","评论": ["去下尧坝古镇？吃下红汤羊肉！超推荐！","古镇大吗？逛完需要多久？不大，2 小时足够","商业化重吗？还好，比其他网红古镇清净","红汤羊肉哪家好吃？入口那家老字号超香！","适合拍照吗？巨出片！穿汉服去绝了","没啥好看的，就一条普通古街","有住宿吗？想住一晚看晨雾"]},{"序号": 6,"正文": "🌊泸州神臂城！南宋抗蒙遗址🌊 📍地址：泸州市合江县神臂城镇 老泸州城遗址！南宋末年抗击蒙古军队的著名山城防御遗址～ 站在这里仿佛能听见当年的金戈铁马！ 🏯必逛亮点： 古城墙、炮台遗址、望江亭、古街道 🍜必吃美食： 神臂城镇：莓酒椒香鹅、当地特色腊肉 周边联动：合江烤鱼、豆花火锅 ✨Tips： 适合历史爱好者，建议带讲解或提前做攻略 自驾前往更方便，景区免费开放 #神臂城遗址 #泸州历史 #小众旅游 #文化旅游 #周末去哪儿","评论": ["适合带孩子去吗？想让孩子了解历史","景区大吗？逛完需要多久？不大，1.5 小时足够","免费开放？那太香了！","莓酒椒香鹅好吃吗？听起来很有特色","没什么看的，就是一堆破城墙","拍照出片吗？很出片！氛围感拉满","周边有停车的地方吗？有的，景区有停车场"]},{"序号": 7,"正文": "🍶泸州先市！酱油里的非遗密码🍶 📍地址：泸州市合江县先市镇 先市酱油！全国重点文物保护单位～ 融合非遗酿造技艺与文旅体验，还能看到 “十万酱缸” 奇观！ 🏭必逛亮点： 先市酱油赤水河庄园、永兴诚酱油文化博览园、非遗酿造技艺展示 🍜必吃美食： 酱油拌饭、生烧羊肉汤、生焖羊肉、酱油风味小食 🌟游玩 Tips： 可以体验酱油酿造 DIY，适合带孩子了解非遗 周边有特色民宿，可住一晚深度体验 #非遗体验 #先市酱油 #泸州旅游 #文化旅游 #小众秘境","评论": ["酱油拌饭真的太香了！简单又美味","十万酱缸奇观震撼吗？超震撼！拍照巨好看","体验酿造 DIY 贵吗？人均 50 左右，很划算","去过一次，感觉很无聊，就是看酱缸","先市酱油可以邮寄吗？可以的，景区有官方店铺","生烧羊肉汤好喝吗？超鲜！冬天喝暖身"]},{"序号": 8,"正文": "🌿泸州福宝古镇！国家级历史文化名镇🌿 📍地址：泸州市合江县福宝镇 相比尧坝古镇，更显古朴和陡峭～ 吊脚楼依山而建，青石板路蜿蜒曲折，满是原始烟火气！ 🏯必逛亮点： 福宝古街、吊脚楼群、福宝森林公园入口 🍜必吃美食： 酸笋炒汤圆、羌霍拌福宝豆干、玉笋爆腊肉、腊味竹筒饭、福宝酥饼 🌟游玩 Tips： 建议住一晚，感受古镇的清晨与夜晚 周边可逛福宝森林公园，适合两日游 #福宝古镇 #泸州旅游 #国家级历史文化名镇 #小众古镇 #周末去哪儿","评论": ["福宝古镇比尧坝清净多了，喜欢！","酸笋炒汤圆是什么黑暗料理？吃起来超香！","古镇住宿条件怎么样？有民宿，干净整洁","不好耍！就是个破古镇，没啥看的","福宝酥饼好吃吗？巨香！买了好几斤带回家","去福宝森林公园方便吗？就在古镇入口附近"]},{"序号": 9,"正文": "🌸泸州荔江镇！荔枝熟了～🌸 📍地址：泸州市合江县荔江镇 “一骑红尘妃子笑” 的快乐，在荔江镇就能拥有！ 漫山遍野的荔枝树，成熟季果香四溢～ 🍒必玩项目： 荔枝采摘、荔枝园拍照、荔枝宴体验 🍜必吃美食： 荔枝酥黄、妃子笑滑肉汤、荔枝冰饮、荔枝酒 🌟游玩 Tips： 荔枝成熟季为 7-8 月，建议提前联系果园 自驾前往更方便，可串联合江城区打卡 #合江荔枝 #荔江镇 #泸州旅游 #夏日旅行 #水果采摘","评论": ["荔枝多少钱一斤呀？旺季大概 10-15 元 / 斤","妃子笑滑肉汤好吃吗？超鲜！荔枝的甜香很特别","可以自己采摘吗？可以的，体验感拉满","去过一次，人太多了，采摘要排队","荔枝酒度数高吗？不高，女生也能喝","除了荔枝还有别的玩的吗？周边有田园风光可以逛"]},{"序号": 10,"正文": "🏞️泸州佛宝森林公园！天然氧吧🏞️ 📍地址：泸州市合江县福宝镇 分为天堂坝、自怀、玉兰山三大景点，各有特色！ 天堂坝看瀑布溪流，自怀看森林高山，玉兰山看竹海丹霞～ 🚶‍♀️必玩项目： 徒步、看瀑布、观竹海、拍丹霞地貌 🍜必吃美食： 全竹宴、腊味竹筒饭、法王寺烤鸡 🌟游玩 Tips： 景区面积大，建议自驾或包车 夏季避暑超合适，平均气温 22℃ #佛宝森林公园 #泸州旅游 #天然氧吧 #避暑胜地 #小众旅行地","评论": ["佛宝玉兰山不好耍！别去！","天堂坝的瀑布超美！拍照巨出片","景区门票多少钱呀？各景点单独收费，人均 50 左右","徒步难度大吗？适合新手吗？还好，有平缓路线","全竹宴在哪里吃？景区周边的农家乐都有","图七的山和云海是哪里？佛宝森林公园的自怀景区～"]},{"序号": 11,"正文": "🍵泸州凤鸣镇！石斛养生之旅🍵 📍地址：泸州市合江县凤鸣镇 金钗石斛之乡！这里的石斛不仅能看，还能吃～ 养生党必打卡！ 🌿必玩项目： 石斛种植基地参观、石斛采摘体验 🍜必吃美食： 石斛老鸭汤、石斛凉粉、石斛花茶、石斛糕点 🌟游玩 Tips： 适合养生游，周边有康养民宿 可购买新鲜石斛或石斛制品带回家 #凤鸣镇 #金钗石斛 #养生之旅 #泸州旅游 #小众秘境","评论": ["石斛老鸭汤超滋补！冬天喝太舒服了","石斛凉粉好吃吗？很清爽，适合夏天","种植基地需要门票吗？不需要，免费参观","感觉就是噱头，石斛制品卖得巨贵","适合带长辈去吗？超适合！长辈很喜欢","石斛花茶多少钱一斤？大概 80-120 元 / 斤"]},{"序号": 12,"正文": "🐟泸州车辋镇！河鲜爱好者天堂🐟 📍地址：泸州市合江县车辋镇 靠河而生的小镇，河鲜新鲜又美味！ 每一口都是河鲜的鲜爽～ 🍜必吃美食： 腊味猪儿粑、丁山椒炒黄辣丁、丁山椒爆鳝鱼、辣炒黄辣丁 🌿必玩项目： 河边散步、钓鱼体验 🌟游玩 Tips： 小镇不大，适合顺路打卡 河鲜价格实惠，人均 50 吃到撑 #车辋镇 #河鲜 #泸州美食 #小众旅行地 #周末去哪儿","评论": ["丁山椒炒黄辣丁太香了！超级下饭","可以自己钓鱼然后让餐馆加工吗？可以的，加工费很便宜","腊味猪儿粑好吃吗？咸香口，超推荐","小镇交通方便吗？建议自驾，公共交通不太方便","去过一次，环境一般，但是味道绝了","钓鱼需要收费吗？部分河段免费，部分收费"]},{"序号": 13,"正文": "🏯泸州真龙镇！柚香满镇🏯 📍地址：泸州市合江县真龙镇 真龙柚的故乡！每到成熟季，全镇都飘着柚香～ 不仅能吃柚，还能吃柚香美食！ 🍊必玩项目： 真龙柚采摘、柚园拍照 🍜必吃美食： 白汤羊肉、柚香爆虾球、柚珍珠羹、真龙柚果汁 🌟游玩 Tips： 真龙柚成熟季为 11-12 月 周边有柚主题民宿，可深度体验 #真龙镇 #真龙柚 #泸州旅游 #水果采摘 #小众旅行地","评论": ["真龙柚超甜！水分也足，每年都买很多","柚香爆虾球好吃吗？柚香解腻，超特别","采摘多少钱一斤？大概 5-8 元 / 斤","除了摘柚子还有别的玩的吗？周边有田园风光","适合亲子游吗？超适合！孩子很喜欢采摘","可以邮寄吗？可以的，商家会帮忙打包"]},{"序号": 14,"正文": "🔥泸州符阳街道！深夜食堂聚集地🔥 📍地址：泸州市合江县符阳街道 合江的烟火气都在这里！深夜的街道全是美食香气～ 🍜必吃美食： 笔架山腊肉、早豆花、折耳根豆花烤鱼、烤全羊、麻辣小龙虾 🌃必玩项目： 逛夜市、吃夜宵、感受市井烟火气 🌟游玩 Tips： 建议晚上前往，夜市超热闹 人均 60 吃到扶墙出 #符阳街道 #合江夜市 #泸州美食 #深夜食堂 #烟火气","评论": ["折耳根豆花烤鱼 YYDS！每次去都要吃","夜市几点开始呀？晚上 7 点左右就开始了","烤全羊多少钱一只？大概 800-1200 元，可拼单","人超级多，建议提前去占位置","味道一般，价格还贵，不推荐","周边好停车吗？不太好停，建议打车"]},{"序号": 15,"正文": "🏞️泸州金龙湖！川南小九寨🏞️ 📍地址：泸州市合江县 高山湖泊，湖水清澈见底，有 “川南小九寨” 的美誉～ 湖周边都是绿植，拍照超美！ 🚶‍♀️必玩项目： 环湖徒步、划船、看湖景、拍大片 🍜必吃美食： 周边农家乐：农家腊肉、鲜鱼火锅 🌟游玩 Tips： 适合半日游，可串联佛宝森林公园一起 夏季避暑超合适，湖水很清凉 #金龙湖 #川南小九寨 #泸州旅游 #避暑胜地 #小众旅行地","评论": ["真的像小九寨吗？有点夸张，但确实很美","可以划船吗？可以的，小船 50 元 / 小时","徒步需要多久？环湖一圈大概 2 小时","没什么好玩的，就是一个小湖","适合野餐吗？超适合！湖边有草坪","门票多少钱呀？免费开放，停车费 10 元"]},{"序号": 16,"正文": "🍗泸州法王寺镇！烤鸡之乡🍗 📍地址：泸州市合江县法王寺镇 因法王寺而闻名，这里的烤鸡更是一绝！ 外皮焦香，内里多汁～ 🏯必逛亮点： 法王寺、古寺庙建筑、寺庙祈福 🍜必吃美食： 法王寺烤鸡、桂花燕窝、寺庙素斋 🌟游玩 Tips： 烤鸡建议提前预定，避免排队 法王寺免费开放，适合静心 #法王寺镇 #法王寺烤鸡 #泸州美食 #文化旅游 #周末去哪儿","评论": ["法王寺烤鸡巨香！每次去都要打包一只","寺庙素斋好吃吗？很清淡，适合养生","法王寺大吗？逛完需要多久？1 小时足够","烤鸡多少钱一只？大概 80-120 元 / 只","感觉很普通，不如其他地方的烤鸡","适合带孩子去吗？适合，寺庙很清净"]},{"序号": 17,"正文": "🌾泸州白米镇！稻田里的美味🌾 📍地址：泸州市合江县白米镇 主打稻田美食！每一口都是新鲜的田园风味～ 🍜必吃美食： 香辣稻田虾、稻田鱼、农家腊肉、新鲜蔬菜 🌿必玩项目： 逛稻田、拍照、体验农耕（季节性） 🌟游玩 Tips： 适合亲子游，农耕体验需提前预约 人均 40 吃到撑 #白米镇 #稻田美食 #泸州旅游 #亲子游 #小众旅行地","评论": ["香辣稻田虾超入味！连壳都能吃","什么时候去能体验农耕？春夏季节","适合拍照吗？稻田拍照巨出片！","就是个普通农村，没什么好玩的","农家菜很新鲜，性价比很高","交通方便吗？建议自驾，公共交通较少"]},{"序号": 18,"正文": "🍷泸州神臂城镇！莓酒飘香🍷 📍地址：泸州市合江县神臂城镇 除了抗蒙遗址，这里的莓酒和特色菜也很绝！ 🍜必吃美食： 莓酒椒香鹅、当地腊肉、鲜鱼火锅、莓酒 🏯必逛亮点： 神臂城遗址、望江亭、古街道 🌟游玩 Tips： 适合一日游，逛遗址吃美食两不误 莓酒可以购买带回家，送人超合适 #神臂城镇 #莓酒椒香鹅 #泸州美食 #文化旅游 #小众旅行地","评论": ["莓酒椒香鹅好吃吗？超香！配莓酒绝了","莓酒度数高吗？不高，女生也能喝","遗址和美食街远吗？不远，步行就能到","去过一次，感觉很一般，不推荐","当地腊肉多少钱一斤？大概 40-60 元 / 斤","适合带长辈去吗？适合，长辈喜欢这种历史 + 美食的组合"]},{"序号": 19,"正文": "🌿泸州白鹿镇！酸椒鱼之乡🌿 📍地址：泸州市合江县白鹿镇 小镇的酸椒鱼名声在外！酸椒是当地自制的，超入味～ 🍜必吃美食： 马庙酸椒鱼、农家腊肉、新鲜蔬菜 🌃必玩项目： 逛小镇、河边散步、感受乡村宁静 🌟游玩 Tips： 适合顺路打卡，人均 40 吃到撑 酸椒可以购买带回家 #白鹿镇 #马庙酸椒鱼 #泸州美食 #小众旅行地 #周末去哪儿","评论": ["马庙酸椒鱼太下饭了！能吃三碗米饭","酸椒多少钱一瓶？大概 15-20 元 / 瓶","小镇环境怎么样？很干净，很宁静","没什么好玩的，就为了吃酸椒鱼去的","适合带孩子去吗？适合，菜味可以做不辣","交通方便吗？建议自驾，公共交通不太方便"]},{"序号": 20,"正文": "🍢泸州临港街道！卤鹅飘香🍢 📍地址：泸州市合江县临港街道 榕山卤鹅、榕山烧鹅是这里的招牌！ 皮香肉嫩，越吃越香～ 🍜必吃美食： 榕山卤鹅、榕山烧鹅、卤味拼盘、特色小吃 🌃必玩项目： 逛街道、吃卤味、感受市井烟火气 🌟游玩 Tips： 卤鹅可以真空打包，适合当伴手礼 人均 30 吃到满足 #临港街道 #榕山卤鹅 #泸州美食 #市井烟火气 #周末去哪儿","评论": ["榕山卤鹅超好吃！每次去都要打包半只","卤鹅多少钱一斤？大概 35-45 元 / 斤","有推荐的店铺吗？街头那家老字号超正宗","味道一般，不如其他地方的卤鹅","可以真空打包吗？可以的，保质期 3-5 天","周边有其他美食吗？有很多小吃店，可顺路打卡"]}]
}

for data in datas["notes"]:
    collection.add(
        ids=str(uuid.uuid4()),
        documents=data["正文"],
        metadatas={
            "comments": data["评论"]
        },
    )

res = collection.hybrid_search(
    query={
        "where_document": {"$contains": "泸州"},
        "n_results": 100,
    },
    knn={
        "query_texts": ["泸州"],
        "n_results": 100,
    },
    n_results=100,
)
print(res)